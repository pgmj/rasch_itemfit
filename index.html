<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Magnus Johansson">
<meta name="dcterms.date" content="2025-01-12">
<meta name="keywords" content="Rasch, Psychometrics, Item fit, Cutoffs, Critical values, Model fit">

<title>Detecting item misfit in Rasch models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1fbc47131a039e0df962caa6cecbb2e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-04808a0abcc183c02ab11ffa5b3696c9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="Detecting item misfit in Rasch models">
<meta name="citation_abstract" content="Psychometrics in general have long relied on rule-of-thumb critical values for various goodness of fit metrics. With more powerful personal computers it is both feasible and desirable to use simulation methods to determine appropriate critical cutoff values. This paper illustrates and evaluates the use of an R package for Rasch psychometrics that has implemented functions to simplify the process of determining simulation based cutoff values. Through a series of simulation studies, a comparison is made between information weighted conditional item fit (&amp;amp;quot;infit&quot;) and item-restscore correlations using Goodman and Kruskal’s $\gamma$. Results indicate the limitations of small samples (n &amp;lt; 500) in correctly detecting item misfit due to multidimensionality, especially when a larger proportion of items are misfit. Item outfit shows very low performance in general. Conditional infit with simulation based cutoffs performs better than item-restscore with sample sizes below 500. Both methods result in problematic rates of false positives with large samples (n &amp;gt;= 1000). Large datasets should be analyzed using nonparametric bootstrap of subsamples with item-restscore to reduce the risk of type-1 errors. Finally, the importance of an iterative analysis process is emphasized, since a situation where several items show underfit will cause other items to show overfit to the Rasch model. Underfit items should be removed one at a time, and a re-analysis conducted for each step to avoid erroneously removing items.
">
<meta name="citation_keywords" content="Rasch,Psychometrics,Item fit,Cutoffs,Critical values,Model fit">
<meta name="citation_author" content="Magnus Johansson">
<meta name="citation_publication_date" content="2025-01-12">
<meta name="citation_cover_date" content="2025-01-12">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-01-12">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=A Rasch Model for Partial Credit Scoring;,citation_abstract=A unidimensional latent trait model for responses scored in two or more ordered categories is developed. This “Partial Credit” model is a member of the family of latent trait models which share the property of parameter separability and so permit “specifically objective” comparisons of persons and items. The model can be viewed as an extension of Andrich’s Rating Scale model to situations in which ordered response alternatives are free to vary in number and structure from item to item. The difference between the parameters in this model and the “category boundaries” in Samejima’s Graded Response model is demonstrated. An unconditional maximum likelihood procedure for estimating the model parameters is developed.;,citation_author=Geoff N. Masters;,citation_publication_date=1982-06;,citation_cover_date=1982-06;,citation_year=1982;,citation_fulltext_html_url=https://www.cambridge.org/core/journals/psychometrika/article/abs/rasch-model-for-partial-credit-scoring/D7202CB6D2D1593889B1318DD6297E01;,citation_issue=2;,citation_doi=10.1007/BF02296272;,citation_issn=0033-3123, 1860-0980;,citation_volume=47;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=An Evaluation of Overall Goodness-of-Fit Tests for the Rasch Model;,citation_abstract=&amp;amp;amp;lt;p&amp;gt;For assessing the fit of item response theory models, it has been suggested to apply overall goodness-of-fit tests as well as tests for individual items and item pairs. Although numerous goodness-of-fit tests have been proposed in the literature for the Rasch model, their relative power against several model violations has not been investigated so far. This study compares four of these tests, which are all available in R software: &amp;lt;italic&amp;gt;T</italic>$_{\textrm{10}}$, <italic>T</italic>$_{\textrm{11}}$, <italic>M</italic>$_{\textrm{2}}$, and the LR test. Results on the Type I error rate and the sensitivity to violations of different assumptions of the Rasch model (unidimensionality, local independence on the level of item pairs, equal item discrimination, zero as a lower asymptote for the item characteristic curves, invariance of the item parameters) are reported. The results indicate that the <italic>T</italic>$_{\textrm{11}}$ test is comparatively most powerful against violations of the assumption of parallel item characteristic curves, which includes the presence of unequal item discriminations and a non-zero lower asymptote. Against the remaining model violations, which can be summarized as local dependence, <italic>M</italic>$_{\textrm{2}}$ is found to be most powerful. <italic>T</italic>$_{\textrm{10}}$ and LR are found to be sensitive against violations of the assumption of parallel item characteristic curves, but are insensitive against local dependence.</p>;,citation_author=Rudolf Debelak;,citation_publication_date=2019-01;,citation_cover_date=2019-01;,citation_year=2019;,citation_fulltext_html_url=https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2018.02710/full;,citation_doi=10.3389/fpsyg.2018.02710;,citation_issn=1664-1078;,citation_volume=9;,citation_journal_title=Frontiers in Psychology;">
<meta name="citation_reference" content="citation_title=A goodness of fit test for the rasch model;,citation_abstract=The Rasch model is an item analysis model with logistic item characteristic curves of equal slope,i.e. with constant item discriminating powers. The proposed goodness of fit test is based on a comparison between difficulties estimated from different scoregroups and over-all estimates.;,citation_author=Erling B. Andersen;,citation_publication_date=1973-03;,citation_cover_date=1973-03;,citation_year=1973;,citation_fulltext_html_url=https://doi.org/10.1007/BF02291180;,citation_issue=1;,citation_doi=10.1007/BF02291180;,citation_issn=1860-0980;,citation_volume=38;,citation_journal_title=Psychometrika;">
<meta name="citation_reference" content="citation_title=Simulation based cutoff values for Rasch item fit and residual correlations;,citation_author=Magnus Johansson;,citation_publication_date=2024-09;,citation_cover_date=2024-09;,citation_year=2024;,citation_fulltext_html_url=https://pgmj.github.io/simcutoffs.html;,citation_journal_title=R, Rasch, etc;">
<meta name="citation_reference" content="citation_title=Applying the Rasch Model: Fundamental Measurement in the Human Sciences;,citation_abstract=Cited over 1900 times, this classic text facilitates a deep understanding of the Rasch model. The authors review the crucial properties of the model and demonstrate its use with a variety of examples from education, psychology, and health. A glossary and numerous illustrations aid the reader’s understanding. Readers learn how to apply Rasch analysis so they can perform their own analyses and interpret the results. The authors present an accessible overview that does not require a mathematical background. &amp;amp;amp;quot; Highlights of the new edition include: &amp;quot; -More learning tools to strengthen readers understanding including chapter introductions, boldfaced key terms, chapter summaries, activities, and suggested readings. -Divided chapters (4, 6, 7 &amp; 8) into &quot;basic&quot; and &quot;extended understanding&quot; sections so readers can select the level most appropriate for their needs and to provide more in-depth investigations of key topics. -A website at www.routledge.com/9780415833424 that features free Rasch software, data sets, an Invariance worksheet, detailed instructions for key analyses, and links to related sources. -Greater emphasis on the role of Rasch measurement as &quot;a priori&quot; in the construction of scales and its use &quot;post hoc&quot; to reveal the extent to which interval scale measurement is instantiated in existing data sets. -Emphasizes the importance of interval level measurement data and demonstrates how Rasch measurement is used to examine measurement invariance. -Insights from other Rasch scholars via innovative applications (Ch. 9). -Extended discussion of invariance now reviews DIF, DPF, and anchoring (ch. 5). -Revised Rating Scale Model material now based on the analysis of the CEAQ (ch.6). -Clarifies the relationships between Rasch measurement, True Score Theory, and Item Response Theory by reviewing their commonalities and differences (Ch.13). -Provides more detail on how to conduct a Rasch analysis so readers can use the techniques on their own (Appendix B). Intended as a text for graduate courses in measurement, item response theory, (advanced) research methods or quantitative analysis taught in psychology, education, human development, business, and other social and health sciences, professionals in these areas also appreciate the book s accessible introduction.&quot;;,citation_author=Trevor Bond;,citation_author=Christine M. Fox;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_isbn=978-1-315-81469-8;">
<meta name="citation_reference" content="citation_title=Visualizing Rasch item fit using conditional item characteristic curves in R;,citation_abstract=New R computer routines that support rigorous statistical validation of psychological tests have recently appeared. We illustrate how Rasch item fit can be evaluated visually and propose an extension of existing implementations in R. We illustrate the utility using two short psychological tests.;,citation_author=Ann-Sophie Buchardt;,citation_author=Karl Bang Christensen;,citation_author=Normann Jensen;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=2;,citation_volume=65;,citation_journal_title=Psychological Test and Assessment Modeling;">
<meta name="citation_reference" content="citation_title=Detecting and evaluating the impact of multidimensionality using item fit statistics and principal component analysis of residuals;,citation_abstract=The purpose of this research is twofold. First is to extend the work of Smith (1992, 1996) and Smith and Miao (1991, 1994) in comparing item fit statistics and principal component analysis as tools for assessing the unidimensionality requirement of Rasch models. Second is to demonstrate methods to explore how violations of the unidimensionality requirement influence person measurement. For the first study, rating scale data were simulated to represent varying degrees of multidimensionality and the proportion of items contributing to each component. The second study used responses to a 24 item Attention Deficit Hyperactivity Disorder scale obtained from 317 college undergraduates. The simulation study reveals both an iterative item fit approach and principal component analysis of standardized residuals are effective in detecting items simulated to contribute to multidimensionality. The methods presented in Study 2 demonstrate the potential impact of multidimensionality on norm and criterion-reference person measure interpretations. The results provide researchers with quantitative information to help assist with the qualitative judgment as to whether the impact of multidimensionality is severe enough to warrant removing items from the analysis.;,citation_author=Everett V Smith;,citation_publication_date=2002-01;,citation_cover_date=2002-01;,citation_year=2002;,citation_issue=2;,citation_issn=1529-7713;,citation_pmid=12011501;,citation_volume=3;,citation_journal_title=Journal of applied measurement;">
<meta name="citation_reference" content="citation_title=Checking Dimensionality in Item Response Models With Principal Component Analysis on Standardized Residuals;,citation_abstract=Dimensionality is an important assumption in item response theory (IRT). Principal component analysis on standardized residuals has been used to check dimensionality, especially under the family of Rasch models. It has been suggested that an eigenvalue greater than 1.5 for the first eigenvalue signifies a violation of unidimensionality when there are 500 persons and 30 items. The cut-point of 1.5 is often used beyond this specific condition of sample size and test length. This study argues that a fixed cut-point is not applicable because the distribution of eigenvalues or their ratios depends on sample size and test length, just like other statistics. The authors conducted a series of simulations to verify this argument. They then proposed three chi-square statistics for multivariate independence to test the correlation matrix obtained from the standardized residuals. Through simulations, it was found that Steiger’s statistic behaved fairly like a chi-square distribution, when its degrees of freedom were adjusted.;,citation_author=Yeh-Tai Chou;,citation_author=Wen-Chung Wang;,citation_publication_date=2010-10;,citation_cover_date=2010-10;,citation_year=2010;,citation_fulltext_html_url=https://doi.org/10.1177/0013164410379322;,citation_issue=5;,citation_doi=10.1177/0013164410379322;,citation_issn=0013-1644;,citation_volume=70;,citation_journal_title=Educational and Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Item Fit Statistics;,citation_abstract=Often it is argued that the parsimonious Rasch model is too simple to have a chance to fit real-life data. Therefore, it is important to provide strong empirical evidence supporting the claim that the Rasch model is adequate for data. This chapter describes two types of item fit statistics that can be used for this purpose. The first type takes all the fundamental assumptions of the Rasch model as given and tries to assess the degree to which the separate items appear to have conditional response probabilities that do not depart from the Rasch model probabilities. The second type addresses the assumption of no differential item functioning (DIF), but does it one item at a time, assuming all the other items do not violate the Rasch model assumptions. The theory of Rasch models uses two types of residuals: individual response residuals and group residuals.;,citation_author=Karl Bang Christensen;,citation_author=Svend Kreiner;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1002/9781118574454.ch5;,citation_doi=10.1002/9781118574454.ch5;,citation_isbn=978-1-118-57445-4;,citation_inbook_title=Rasch Models in Health;">
<meta name="citation_reference" content="citation_title=Critical Values for Yen’s Q3: Identification of Local Dependence in the Rasch Model Using Residual Correlations;,citation_abstract=The assumption of local independence is central to all item response theory (IRT) models. Violations can lead to inflated estimates of reliability and problems with construct validity. For the most widely used fit statistic Q3, there are currently no well-documented suggestions of the critical values which should be used to indicate local dependence (LD), and for this reason, a variety of arbitrary rules of thumb are used. In this study, an empirical data example and Monte Carlo simulation were used to investigate the different factors that can influence the null distribution of residual correlations, with the objective of proposing guidelines that researchers and practitioners can follow when making decisions about LD during scale development and validation. A parametric bootstrapping procedure should be implemented in each separate situation to obtain the critical value of LD applicable to the data set, and provide example critical values for a number of data structure situations. The results show that for the Q3 fit statistic, no single critical value is appropriate for all situations, as the percentiles in the empirical null distribution are influenced by the number of items, the sample size, and the number of response categories. Furthermore, the results show that LD should be considered relative to the average observed residual correlation, rather than to a uniform value, as this results in more stable percentiles for the null distribution of an adjusted fit statistic.;,citation_author=Karl Bang Christensen;,citation_author=Guido Makransky;,citation_author=Mike Horton;,citation_publication_date=2017-05;,citation_cover_date=2017-05;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1177/0146621616677520;,citation_issue=3;,citation_doi=10.1177/0146621616677520;,citation_issn=0146-6216;,citation_volume=41;,citation_journal_title=Applied Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Direct Discrepancy Dynamic Fit Index Cutoffs for Arbitrary Covariance Structure Models;,citation_abstract=Despite the popularity of traditional fit index cutoffs like RMSEA ≤ .06 and CFI ≥ .95, several studies have noted issues with overgeneralizing traditional cutoffs. Computational methods have been proposed to avoid overgeneralization by deriving cutoffs specifically tailored to the characteristics of the model being evaluated. Simulations show favorable performance of these methods; however, these methods support a narrow set of scenarios (e.g., certain models or response scales) and the interpretation of cutoffs is not always standardized, which affects empirical researchers’ ability to confidently and broadly adopt these methods to evaluate model fit. In this paper, we propose an extension to one recently developed computational method—dynamic fit index cutoffs—that (a) permits application to any covariance structure model (e.g., CFA, mediation, bifactor), (b) standardizes interpretation of cutoffs across any covariance structure model, and (c) supports normal, nonnormal, categorical, and missing data. Software is provided to facilitate implementation of the method.;,citation_author=Daniel McNeish;,citation_author=Melissa G. Wolf;,citation_publication_date=2024-09;,citation_cover_date=2024-09;,citation_year=2024;,citation_fulltext_html_url=https://doi.org/10.1080/10705511.2024.2308005;,citation_issue=5;,citation_doi=10.1080/10705511.2024.2308005;,citation_issn=1070-5511;,citation_volume=31;,citation_journal_title=Structural Equation Modeling: A Multidisciplinary Journal;">
<meta name="citation_reference" content="citation_title=Measures of Association for Cross Classifications;,citation_abstract=When populations are cross-classified with respect to two or more classifications or polytomies, questions often arise about the degree of association existing between the several polytomies. Most of the traditional measures or indices of association are based upon the standard chi-square statistic or on an assumption of underlying joint normality. In this paper a number of alternative measures are considered, almost all based upon a probabilistic model for activity to which the cross-classification may typically lead. Only the case in which the population is completely known is considered, so no question of sampling or measurement error appears. We hope, however, to publish before long some approximate distributions for sample estimators of the measures we propose, and approximate tests of hypotheses. Our major theme is that the measures of association used by an empirical investigator should not be blindly chosen because of tradition and convention only, although these factors may properly be given some weight, but should be constructed in a manner having operational meaning within the context of the particular problem.;,citation_author=Leo A. Goodman;,citation_author=William H. Kruskal;,citation_publication_date=1954;,citation_cover_date=1954;,citation_year=1954;,citation_fulltext_html_url=https://www.jstor.org/stable/2281536;,citation_issue=268;,citation_doi=10.2307/2281536;,citation_issn=0162-1459;,citation_volume=49;,citation_journal_title=Journal of the American Statistical Association;">
<meta name="citation_reference" content="citation_title=Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing;,citation_abstract=The common approach to the multiplicity problem calls for controlling the familywise error rate (FWER). This approach, though, has faults, and we point out a few. A different approach to problems of multiple significance testing is presented. It calls for controlling the expected proportion of falsely rejected hypotheses — the false discovery rate. This error rate is equivalent to the FWER when all hypotheses are true but is smaller otherwise. Therefore, in problems where the control of the false discovery rate rather than that of the FWER is desired, there is potential for a gain in power. A simple sequential Bonferronitype procedure is proved to control the false discovery rate for independent test statistics, and a simulation study shows that the gain in power is substantial. The use of the new procedure and the appropriateness of the criterion are illustrated with examples.;,citation_author=Yoav Benjamini;,citation_author=Yosef Hochberg;,citation_publication_date=1995-01;,citation_cover_date=1995-01;,citation_year=1995;,citation_fulltext_html_url=https://doi.org/10.1111/j.2517-6161.1995.tb02031.x;,citation_issue=1;,citation_doi=10.1111/j.2517-6161.1995.tb02031.x;,citation_issn=0035-9246;,citation_volume=57;,citation_journal_title=Journal of the Royal Statistical Society: Series B (Methodological);">
<meta name="citation_reference" content="citation_title=Using item mean squares to evaluate fit to the Rasch model;,citation_abstract=Throughout the mid to late 1970’s considerable research was conducted on the properties of Rasch fit mean squares. This work culminated in a variety of transformations to convert the mean squares into approximate t-statistics. This work was primarily motivated by the influence sample size has on the magnitude of the mean squares and the desire to have a single critical value that can generally be applied to most cases. In the late 1980’s and the early 1990’s the trend seems to have reversed, with numerous researchers using the untransformed fit mean squares as a means of testing fit to the Rasch measurement models. The principal motivation is cited as the influence sample size has on the sensitivity of the t-converted mean squares. The purpose of this paper is to present the historical development of these fit indices and the various transformations and to examine the impact of sample size on both the fit mean squares and the t-transformations of those mean squares. Because the sample size problem has little influence on the person mean square problem, due to the relatively short length (100 items or less), this paper focuses on the item fit mean squares, where it is common to find the statistics used with sample sizes ranging from 30 to 10,000.;,citation_author=R. M. Smith;,citation_author=R. E. Schumacker;,citation_author=M. J. Bush;,citation_publication_date=1998;,citation_cover_date=1998;,citation_year=1998;,citation_issue=1;,citation_issn=1090-655X;,citation_pmid=9661732;,citation_volume=2;,citation_journal_title=Journal of Outcome Measurement;">
<meta name="citation_reference" content="citation_title=Polytomous Item Response Theory Models;,citation_author=Remo Ostini;,citation_author=Michael Nering;,citation_publication_date=2006;,citation_cover_date=2006;,citation_year=2006;,citation_fulltext_html_url=https://methods.sagepub.com/book/polytomous-item-response-theory-models;,citation_doi=10.4135/9781412985413;,citation_isbn=978-0-7619-3068-6 978-1-4129-8541-3;">
<meta name="citation_reference" content="citation_title=Item fit statistics for Rasch analysis: Can we trust them?;,citation_abstract=To compare fit statistics for the Rasch model based on estimates of unconditional or conditional response probabilities.;,citation_author=Marianne Müller;,citation_publication_date=2020-08;,citation_cover_date=2020-08;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1186/s40488-020-00108-7;,citation_issue=1;,citation_doi=10.1186/s40488-020-00108-7;,citation_issn=2195-5832;,citation_volume=7;,citation_journal_title=Journal of Statistical Distributions and Applications;">
<meta name="citation_reference" content="citation_title=A Note on Item–Restscore Association in Rasch Models;,citation_author=Svend Kreiner;,citation_publication_date=2011-10;,citation_cover_date=2011-10;,citation_year=2011;,citation_fulltext_html_url=https://doi.org/10.1177/0146621611410227;,citation_issue=7;,citation_doi=10.1177/0146621611410227;,citation_issn=0146-6216;,citation_volume=35;,citation_journal_title=Applied Psychological Measurement;">
<meta name="citation_reference" content="citation_title=Iarm: Item Analysis in Rasch Models;,citation_abstract=Tools to assess model fit and identify misfitting items for Rasch models (RM) and partial credit models (PCM). Included are item fit statistics, item characteristic curves, item-restscore association, conditional likelihood ratio tests, assessment of measurement error, estimates of the reliability and test targeting as described in Christensen et al. (Eds.) (2013, ISBN:978-1-84821-222-0).;,citation_author=Marianne Mueller;,citation_author=Pedro Henrique Ribeiro Santiago;,citation_publication_date=2022-08;,citation_cover_date=2022-08;,citation_year=2022;,citation_fulltext_html_url=https://cran.r-project.org/web/packages/iarm/index.html;">
<meta name="citation_reference" content="citation_title=easyRasch: Psychometric analysis in r with rasch measurement theory;,citation_author=Magnus Johansson;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://github.com/pgmj/easyRasch;">
<meta name="citation_reference" content="citation_title=Extended Rasch Modeling: The eRm Package for the Application of IRT Models in R;,citation_author=Patrick Mair;,citation_author=Reinhold Hatzinger;,citation_publication_date=2007-02;,citation_cover_date=2007-02;,citation_year=2007;,citation_fulltext_html_url=https://www.jstatsoft.org/index.php/jss/article/view/v020i09;,citation_issue=1;,citation_doi=10.18637/jss.v020.i09;,citation_issn=1548-7660;,citation_volume=20;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Weighted likelihood estimation of ability in item response theory;,citation_abstract=Applications of item response theory, which depend upon its parameter invariance property, require that parameter estimates be unbiased. A new method, weighted likelihood estimation (WLE), is derived, and proved to be less biased than maximum likelihood estimation (MLE) with the same asymptotic variance and normal distribution. WLE removes the first order bias term from MLE. Two Monte Carlo studies compare WLE with MLE and Bayesian modal estimation (BME) of ability in conventional tests and tailored tests, assuming the item parameters are known constants. The Monte Carlo studies favor WLE over MLE and BME on several criteria over a wide range of the ability scale.;,citation_author=Thomas A. Warm;,citation_publication_date=1989-09;,citation_cover_date=1989-09;,citation_year=1989;,citation_fulltext_html_url=https://doi.org/10.1007/BF02294627;,citation_issue=3;,citation_doi=10.1007/BF02294627;,citation_issn=1860-0980;,citation_volume=54;,citation_journal_title=Psychometrika;">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Detecting item misfit in Rasch models</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Author</div>
          <div class="quarto-title-meta-heading">Affiliations</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Magnus Johansson <a href="https://orcid.org/0000-0003-1669-592X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        RISE Research Institutes of Sweden, Division Built Environment, System Transition
                      </p>
                    <p class="affiliation">
                        Centre for Psychiatry Research, Department of Clinical Neuroscience, Karolinska Institutet, &amp; Stockholm Health Care Services, Region Stockholm
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">January 12, 2025</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></p></div><div class="quarto-title-meta-contents"><p><a href="index.docx"><i class="bi bi-file-word"></i>MS Word (apaquarto)</a></p></div></div></div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>Psychometrics in general have long relied on rule-of-thumb critical values for various goodness of fit metrics. With more powerful personal computers it is both feasible and desirable to use simulation methods to determine appropriate critical cutoff values. This paper illustrates and evaluates the use of an R package for Rasch psychometrics that has implemented functions to simplify the process of determining simulation based cutoff values. Through a series of simulation studies, a comparison is made between information weighted conditional item fit (“infit”) and item-restscore correlations using Goodman and Kruskal’s <span class="math inline">\(\gamma\)</span>. Results indicate the limitations of small samples (n &lt; 500) in correctly detecting item misfit due to multidimensionality, especially when a larger proportion of items are misfit. Item outfit shows very low performance in general. Conditional infit with simulation based cutoffs performs better than item-restscore with sample sizes below 500. Both methods result in problematic rates of false positives with large samples (n &gt;= 1000). Large datasets should be analyzed using nonparametric bootstrap of subsamples with item-restscore to reduce the risk of type-1 errors. Finally, the importance of an iterative analysis process is emphasized, since a situation where several items show underfit will cause other items to show overfit to the Rasch model. Underfit items should be removed one at a time, and a re-analysis conducted for each step to avoid erroneously removing items.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>Rasch, Psychometrics, Item fit, Cutoffs, Critical values, Model fit</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="header-section-number">2</span> Methods</a></li>
  <li><a href="#study-1-item-infit-and-outfit" id="toc-study-1-item-infit-and-outfit" class="nav-link" data-scroll-target="#study-1-item-infit-and-outfit"><span class="header-section-number">3</span> Study 1: Item infit and outfit</a>
  <ul class="collapse">
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3.1</span> Results</a>
  <ul class="collapse">
  <li><a href="#infit" id="toc-infit" class="nav-link" data-scroll-target="#infit"><span class="header-section-number">3.1.1</span> Infit</a></li>
  <li><a href="#outfit" id="toc-outfit" class="nav-link" data-scroll-target="#outfit"><span class="header-section-number">3.1.2</span> Outfit</a></li>
  <li><a href="#comments" id="toc-comments" class="nav-link" data-scroll-target="#comments"><span class="header-section-number">3.1.3</span> Comments</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#study-2-item-restscore" id="toc-study-2-item-restscore" class="nav-link" data-scroll-target="#study-2-item-restscore"><span class="header-section-number">4</span> Study 2: Item-restscore</a>
  <ul class="collapse">
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1"><span class="header-section-number">4.1</span> Results</a></li>
  </ul></li>
  <li><a href="#study-3-comparing-infit-and-item-restscore" id="toc-study-3-comparing-infit-and-item-restscore" class="nav-link" data-scroll-target="#study-3-comparing-infit-and-item-restscore"><span class="header-section-number">5</span> Study 3: Comparing infit and item-restscore</a>
  <ul class="collapse">
  <li><a href="#results-2" id="toc-results-2" class="nav-link" data-scroll-target="#results-2"><span class="header-section-number">5.0.1</span> Results</a></li>
  </ul></li>
  <li><a href="#study-4-bootstrapped-item-restscore" id="toc-study-4-bootstrapped-item-restscore" class="nav-link" data-scroll-target="#study-4-bootstrapped-item-restscore"><span class="header-section-number">6</span> Study 4: Bootstrapped item-restscore</a>
  <ul class="collapse">
  <li><a href="#results-3" id="toc-results-3" class="nav-link" data-scroll-target="#results-3"><span class="header-section-number">6.1</span> Results</a></li>
  <li><a href="#small-sample-n-150" id="toc-small-sample-n-150" class="nav-link" data-scroll-target="#small-sample-n-150"><span class="header-section-number">6.2</span> Small sample (n = 150)</a></li>
  </ul></li>
  <li><a href="#study-5-varying-the-number-of-items" id="toc-study-5-varying-the-number-of-items" class="nav-link" data-scroll-target="#study-5-varying-the-number-of-items"><span class="header-section-number">7</span> Study 5: Varying the number of items</a>
  <ul class="collapse">
  <li><a href="#results-40-items" id="toc-results-40-items" class="nav-link" data-scroll-target="#results-40-items"><span class="header-section-number">7.1</span> Results 40 items</a></li>
  <li><a href="#results-10-items" id="toc-results-10-items" class="nav-link" data-scroll-target="#results-10-items"><span class="header-section-number">7.2</span> Results 10 items</a></li>
  <li><a href="#summary-figure" id="toc-summary-figure" class="nav-link" data-scroll-target="#summary-figure"><span class="header-section-number">7.3</span> Summary figure</a></li>
  </ul></li>
  <li><a href="#study-6-conditional-likelihood-ratio-test" id="toc-study-6-conditional-likelihood-ratio-test" class="nav-link" data-scroll-target="#study-6-conditional-likelihood-ratio-test"><span class="header-section-number">8</span> Study 6: Conditional likelihood ratio test</a>
  <ul class="collapse">
  <li><a href="#results-4" id="toc-results-4" class="nav-link" data-scroll-target="#results-4"><span class="header-section-number">8.1</span> Results</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">9</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">9.1</span> Limitations</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">10</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#sec-addmat" id="toc-sec-addmat" class="nav-link" data-scroll-target="#sec-addmat"><span class="header-section-number">11</span> Additional materials</a>
  <ul class="collapse">
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">11.1</span> Session info</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="index-preview.html"><i class="bi bi-journal-code"></i>Article Notebook</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This paper presents a series of simulations conducted to evaluate methods to detect item misfit due to multidimensionality in Rasch models. First, conditional item infit and outfit <span class="citation" data-cites="muller_item_2020">(<a href="#ref-muller_item_2020" role="doc-biblioref">Müller 2020</a>)</span> will be under scrutiny. Second, item infit will be compared to the item-restscore method [<span class="citation" data-cites="kreiner_note_2011">Kreiner (<a href="#ref-kreiner_note_2011" role="doc-biblioref">2011</a>)</span>;christensen_item_2013]. Third, a bootstrap method for item-restscore will be presented and tested. This paper is intended for a target group of those who make practical use of Rasch analysis and wish to better understand the expected performance of methods available. As such, we refer readers interested in mathematical and statistical descriptions of the methods to referenced papers detailing this aspect. Only two simple performance metrics will be presented in the results: correct detection rate and false positive rate, both in percentages.</p>
<p>The evaluation of item fit under the Rasch model has, in the majority of published psychometric papers, been conducted using various more or less arbitrary rule-of-thumb critical values. Regarding mean squared (MSQ) item residuals, which should ideally be centered around 1.0, there are two sources often cited. One is the book by Bond &amp; Fox <span class="citation" data-cites="bond_applying_2015">(<a href="#ref-bond_applying_2015" role="doc-biblioref">2015</a>)</span>, which has garnered around 12 000 citations according to Google Scholar]. It contains a table with rule-of-thumb recommendations for various settings, ranging from 0.8–1.2 to 0.5–1.7. Another frequently seen source, which is not an actual peer-reviewed publication and thus lacks citation counts, is the webpage at <a href="https://rasch.org/rmt/rmt162f.htm" class="uri">https://rasch.org/rmt/rmt162f.htm</a>, where Mike Linacre states 0.5-1.5 to be “productive for measurement”. Neither of these sources seem to rely on simulation studies to support their recommendations. While it is reasonable to accept a non-perfect fit to the Rasch model and also describe what one defines as acceptable levels of misfit, such recommendations would seem less arbitrary if related to simulations showing the range of item fit values found when simulating data that fit the Rasch model.</p>
<p>Müller <span class="citation" data-cites="muller_item_2020">(<a href="#ref-muller_item_2020" role="doc-biblioref">2020</a>)</span> used simulation to show how the range of critical values for conditional item infit varies with sample size. The expected average conditional item infit range was described by Müller as fairly well captured by Smith’s rule-of-thumb formula 1±2/<span class="math inline">\(\sqrt{n}\)</span> <span class="citation" data-cites="smith_using_1998">(<a href="#ref-smith_using_1998" role="doc-biblioref">R. M. Smith, Schumacker, and Bush 1998</a>)</span>. However, the average range does not apply for all items within a dataset, since item location relative to sample location also affects model expected item fit. This means that some items within a set of items varying in location are likely to have item fit values outside Smith’s average value range while still fitting the Rasch model. Each item has its own variations in the range of expected item fit.</p>
<p>While evaluation of item fit is an essential part of evaluating unidimensionality, it is recommended to use multiple methods. Standardized residuals are frequently analyzed, commonly with principal component analysis (PCA) and an analysis of residual correlations amongst item pairs, often referred to as Yen’s Q3. Chou and Wang <span class="citation" data-cites="chou_checking_2010">(<a href="#ref-chou_checking_2010" role="doc-biblioref">2010</a>)</span> showed that the critical value for PCA of residuals to support unidimensionality suggested by Smith <span class="citation" data-cites="smith_detecting_2002">(<a href="#ref-smith_detecting_2002" role="doc-biblioref">2002</a>)</span>, using the largest eigenvalue &lt; 1.5, is not generally applicable since it is affected by both test length and sample size. Christensen and colleagues <span class="citation" data-cites="christensen_critical_2017">(<a href="#ref-christensen_critical_2017" role="doc-biblioref">2017</a>)</span> used simulation methods to illustrate the expected range of residual correlations under different conditions. Both of these papers provide important information about the dubiousness in using rule-of-thumb critical values when the empirical distribution of a statistic is not known, but they leave practitioners without tools to determine appropriate cutoffs to apply in practical analysis work.</p>
<p>It is here proposed that by using bootstrapping one can establish item fit critical cutoff values that are relevant for a specific sample and item set. The procedure uses the properties of the available data and simulates multiple new response datasets that fit the Rasch model to determine the range of plausible item fit values for each item. The R package <code>easyRasch</code> <span class="citation" data-cites="easyrasch">(<a href="#ref-easyrasch" role="doc-biblioref">Johansson 2024a</a>)</span> includes a function to determine item infit and outfit cutoff values using this method and will be tested in the simulation studies in this paper.</p>
<p>Similar developments, moving from rule-of-thumb towards adaptive critical values, have recently taken place in the related field of confirmatory factor analysis. McNeish and Wolf <span class="citation" data-cites="mcneish_direct_2024">(<a href="#ref-mcneish_direct_2024" role="doc-biblioref">2024</a>)</span> have created an R package called <code>dynamic</code> that uses bootstrapping to determine appropriate critical values for commonly used model fit metrics for models using ordinal or interval data.</p>
<p>It is important to note that the conditional item fit described by Müller <span class="citation" data-cites="muller_item_2020">(<a href="#ref-muller_item_2020" role="doc-biblioref">2020</a>)</span> and implemented in the <code>iarm</code> R package <span class="citation" data-cites="mueller_iarm_2022">(<a href="#ref-mueller_iarm_2022" role="doc-biblioref">Mueller and Santiago 2022</a>)</span> should not be confused with the unconditional item fit implemented in software such as Winsteps and RUMM2030, as well as all R packages except <code>iarm</code>. Unconditional item fit can result in unreliable item fit in sample sizes as small as 200 with increasing probability of problems as sample size increases. Readers are strongly recommended to read Müller’s paper to fully understand the issues with unconditional item fit. Additionally, the experienced Rasch analyst will perhaps wonder why the Wilson-Hilferty transformed Z statistic (often abbreviated ZSTD), which is based on unconditional MSQ is not included in this analysis. This is also explained in Müller’s paper, where she describes both the notorious problems with sample size and shows that conditional item fit makes ZSTD superfluous. The <code>easyRasch</code> package, which is used in this paper, uses the <code>iarm</code> implementation of conditional item fit.</p>
<p>Currently, there are no published studies on the performance the item-restscore method, as described by Kreiner and Christensen [<span class="citation" data-cites="kreiner_note_2011">Kreiner (<a href="#ref-kreiner_note_2011" role="doc-biblioref">2011</a>)</span>;christensen_item_2013], in detecting misfitting items. Comparing it with an improved version of the long used item infit/outfit methods seemed like a good setting to evaluate item-restscore. The conditional likelihood ratio test <span class="citation" data-cites="andersen_goodness_1973">(<a href="#ref-andersen_goodness_1973" role="doc-biblioref">Andersen 1973</a>)</span> is included in Study 6, since it is a global test of fit that many are likely to be familiar with. As such, it also serves as a point of reference.</p>
<p>There are six simulation studies included in this paper:</p>
<ol type="1">
<li>Conditional item infit and outfit</li>
<li>Item-restscore</li>
<li>Comparing infit and item-restscore</li>
<li>Bootstrapped item-restscore</li>
<li>Varying the number of items</li>
<li>Conditional likelihood ratio test</li>
</ol>
</section>
<section id="methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Methods</h1>
<p>A fully reproducible manuscript with R code and data is available on GitHub: <a href="https://github.com/pgmj/rasch_itemfit" class="uri">https://github.com/pgmj/rasch_itemfit</a>. Each study included in this paper has its own brief introduction and method section. This is a general description of methods used.</p>
<p>The simulation of response data used three steps: First, a vector of theta values (person scores on the latent variable’s logit scale) were generated using <code>rnorm(mean = 0, sd = 1.5)</code>. Second, a set of item locations ranging from -2 to 2 logits were generated for dichotomous items, using <code>runif(n = 20, min = -2, max = 2)</code>. Third, the theta values were used to simulate item responses for participants, using <code>sim.xdim()</code> from the <code>eRm</code> package <span class="citation" data-cites="mair_extended_2007">(<a href="#ref-mair_extended_2007" role="doc-biblioref">Mair and Hatzinger 2007</a>)</span>, which allows simulation of multidimensional response data. Multiple datasets with 10 000 respondents each were generated using the same item and person parameters, varying the targeting of the misfitting item(s) and number of the misfitting item(s). More details are described under the separate studies. The parametric bootstrapping procedure was implemented using random samples from the simulated datasets. Sample size variations tested are described under each study.</p>
<p>The general procedure for the parametric bootstrapping is as follows:</p>
<ol type="1">
<li>Estimation of item locations based on simulated item response data, using conditional maximum likelihood <span class="citation" data-cites="mair_extended_2007">(CML, <a href="#ref-mair_extended_2007" role="doc-biblioref">Mair and Hatzinger 2007</a>)</span>.</li>
<li>Estimation of sample theta values using weighted maximum likelihood <span class="citation" data-cites="warm_weighted_1989">(<a href="#ref-warm_weighted_1989" role="doc-biblioref">Warm 1989</a>)</span>.</li>
<li>Simulation of new response data which fit the Rasch model, using the estimated item locations and theta values.</li>
<li>Estimation of the dichotomous Rasch model for the new response data using CML.</li>
<li>Based on step 4, calculation of conditional item infit and outfit <span class="citation" data-cites="muller_item_2020 mueller_iarm_2022">(<a href="#ref-muller_item_2020" role="doc-biblioref">Müller 2020</a>; <a href="#ref-mueller_iarm_2022" role="doc-biblioref">Mueller and Santiago 2022</a>)</span> and/or item-restscore metrics <span class="citation" data-cites="kreiner_note_2011 mueller_iarm_2022">(<a href="#ref-kreiner_note_2011" role="doc-biblioref">Kreiner 2011</a>; <a href="#ref-mueller_iarm_2022" role="doc-biblioref">Mueller and Santiago 2022</a>)</span>.</li>
</ol>
<p>Steps three and four were iterated over, using resampling with replacement from the estimated theta values as a basis for simulating the response data in step three.</p>
<p>Summary statistics were created with focus on the percentage of correct detection of misfit and false positives.</p>
<p>A complete list of software used for the analyses is listed in #sec-addmat.</p>
</section>
<section id="study-1-item-infit-and-outfit" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Study 1: Item infit and outfit</h1>
<p>Item mean square standardized residuals are either unweighted, which is referred to as “outfit”, or information weighted, which we call “infit” <span class="citation" data-cites="ostini_polytomous_2006">(<a href="#ref-ostini_polytomous_2006" role="doc-biblioref">Ostini and Nering 2006, 86–87</a>)</span>. For details on conditional item fit we refer to the previously mentioned paper by Müller <span class="citation" data-cites="muller_item_2020">(<a href="#ref-muller_item_2020" role="doc-biblioref">2020</a>)</span>. Conditional item infit and outfit are expected to be near 1, with higher values indicating an item to be underfitting the Rasch model (often due to multidimensionality issues) and lower values indicating overfit.</p>
<p>The function <code>RIgetfit()</code> from the <code>easyRasch</code> R package is tested here. It’s source code can be accessed on GitHub, see #sec-addmat. The function offers the user a choice of the number of bootstrap iterations to use to determine the critical cutoff values for each item’s infit and outfit. Our main interest in this study is two-fold. We want to test variations in the number of iterations used in <code>RIgetfit()</code> and evaluate how well the critical values based on the parametric bootstrapping procedure detects misfitting items. Additionally, a comparison between infit and outfit statistics in terms of detection rate and false positive rate will be conducted.</p>
<p>20 dichotomous items are used, with one item misfitting. Item locations are the same throughout all studies unless otherwise noted. The location of the misfitting item relative the to the sample theta mean was selected to be approximately 0, -1, and -2 logits. Three separate datasets were generated with these variations, each with 10 000 simulated respondents. One dataset with all three misfitting items was also generated, using the same sample size.</p>
<p>Then the <code>RIitemfit()</code> function is used to summarize the bootstrap results and also calculates the infit and outfit for each item in the observed data and highlights items with infit/outfit values outside of the cutoff values. <code>RIitemfit()</code> has a default (user modifiable) setting to slightly truncate the distribution of values using <code>stats::quantile()</code> at 0.001 and 0.999 to remove extreme values. An example is demonstrated in <a href="#tbl-itemfit1" class="quarto-xref">Table&nbsp;1</a>, using a subset of the items used in the simulations. <a href="#fig-itemfit1" class="quarto-xref">Figure&nbsp;1</a> provides a visualization of the distribution of bootstrapped infit and outfit values, together with the infit/outfit values from the observed data illustrated using an orange diamond shape. Note the variation between items in plausible values of infit and outfit based on the bootstrap, and that Smith’s rule-of-thumb regarding infit (1±2/<span class="math inline">\(\sqrt{n}\)</span>) would be 0.9-1.1 for a sample size of 400.</p>
<p>This study was rather computationally demanding since each simulation run entailed 100-400 underlying bootstrap iterations. The sample sizes used were 150, 250, 500, and 1000. The number of iterations to determine cutoff values were 100, 200, and 400. Sample size and iteration conditions were fully crossed with each other and the three different targeting variations of the one misfitting item, resulting in 4<em>3</em>3 = 36 conditions. Each combination used 200 simulation runs. The simulations took about 12 hours to run on a Macbook Pro Max M1 using 9 CPU cores.</p>
<div class="cell">
<div id="tbl-itemfit1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-itemfit1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Conditional item fit with simulation based cutoff values
</figcaption>
<div aria-describedby="tbl-itemfit1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 10%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Item</th>
<th style="text-align: right;">InfitMSQ</th>
<th style="text-align: left;">Infit thresholds</th>
<th style="text-align: right;">OutfitMSQ</th>
<th style="text-align: left;">Outfit thresholds</th>
<th style="text-align: left;">Infit diff</th>
<th style="text-align: left;">Outfit diff</th>
<th style="text-align: right;">Location</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">V1</td>
<td style="text-align: right;">1.017</td>
<td style="text-align: left;">[0.869, 1.172]</td>
<td style="text-align: right;">1.061</td>
<td style="text-align: left;">[0.657, 1.74]</td>
<td style="text-align: left;">no misfit</td>
<td style="text-align: left;">no misfit</td>
<td style="text-align: right;">-1.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">V11</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">[0.826, 1.18]</td>
<td style="text-align: right;">1.032</td>
<td style="text-align: left;">[0.729, 1.353]</td>
<td style="text-align: left;">no misfit</td>
<td style="text-align: left;">no misfit</td>
<td style="text-align: right;">-0.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V3</td>
<td style="text-align: right;">1.022</td>
<td style="text-align: left;">[0.91, 1.103]</td>
<td style="text-align: right;">1.050</td>
<td style="text-align: left;">[0.703, 1.483]</td>
<td style="text-align: left;">no misfit</td>
<td style="text-align: left;">no misfit</td>
<td style="text-align: right;">0.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">V12</td>
<td style="text-align: right;">0.966</td>
<td style="text-align: left;">[0.858, 1.201]</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: left;">[0.766, 1.293]</td>
<td style="text-align: left;">no misfit</td>
<td style="text-align: left;">no misfit</td>
<td style="text-align: right;">1.58</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="index-preview.html">Source: Article Notebook</a></div>
<div id="cell-fig-itemfit1" class="cell">
<div class="cell-output-display">
<div id="fig-itemfit1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-itemfit1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-itemfit1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Distribution of simulation based item fit and estimated item fit from observed data"><img src="index_files/figure-html/fig-itemfit1-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemfit1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Distribution of simulation based item fit and estimated item fit from observed data
</figcaption>
</figure>
</div>
</div>
</div>
<section id="results" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="results"><span class="header-section-number">3.1</span> Results</h2>
<p>Figures show the percent of simulation runs that have identified an item as misfitting. Items with more than 5% are colored in light red. A number representing the detection rate is shown adjacent to the bar representing the misfitting item. The figure grid columns are labelled with the number of iterations used by <code>RIgetfit()</code> to determine cutoff values, and grid rows are labelled with the sample size.</p>
<section id="infit" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="infit"><span class="header-section-number">3.1.1</span> Infit</h3>
<div id="cell-fig-ifb0" class="cell">
<div class="cell-output-display">
<div id="fig-ifb0" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb0-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Conditional infit detection rate (misfit item at 0 logits)"><img src="index_files/figure-html/fig-ifb0-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Conditional infit detection rate (misfit item at 0 logits)
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-ifb0" class="quarto-xref">Figure&nbsp;2</a> shows the detection rate when the misfitting item is located at the sample mean. Detection rate is highest for the condition with 100 iterations with sample size 150 and 250, but it also shows higher levels of false positives when sample size increases to 500 or more.</p>
<div id="cell-fig-ifb1" class="cell">
<div class="cell-output-display">
<div id="fig-ifb1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Conditional infit detection rate (misfit item at -1 logits)"><img src="index_files/figure-html/fig-ifb1-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Conditional infit detection rate (misfit item at -1 logits)
</figcaption>
</figure>
</div>
</div>
</div>
<p>When the misfitting item is offset in targeting by -1 logits compared to the sample mean (see <a href="#fig-ifb1" class="quarto-xref">Figure&nbsp;3</a>), the smallest sample size has less power to detect misfit compared to the on-target misfitting item. There are lower rates of false positives across all sample sizes and iterations.</p>
<div id="cell-fig-ifb2" class="cell">
<div class="cell-output-display">
<div id="fig-ifb2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Conditional infit detection rate (misfit item at -2 logits)"><img src="index_files/figure-html/fig-ifb2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Conditional infit detection rate (misfit item at -2 logits)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Finally, when the misfitting item is located at -2 logits compared to the sample mean (see <a href="#fig-ifb2" class="quarto-xref">Figure&nbsp;4</a>), we see a stronger reduction in power for sample sizes 150 and 250. No false positives are identified.</p>
</section>
<section id="outfit" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="outfit"><span class="header-section-number">3.1.2</span> Outfit</h3>
<div id="cell-fig-ifb0out" class="cell">
<div class="cell-output-display">
<div id="fig-ifb0out" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb0out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb0out-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Conditional outfit detection rate (misfit item at 0 logits)"><img src="index_files/figure-html/fig-ifb0out-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb0out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Conditional outfit detection rate (misfit item at 0 logits)
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-ifb1out" class="cell">
<div class="cell-output-display">
<div id="fig-ifb1out" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb1out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb1out-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Conditional outfit detection rate (misfit item at -1 logits)"><img src="index_files/figure-html/fig-ifb1out-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb1out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Conditional outfit detection rate (misfit item at -1 logits)
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-ifb2out" class="cell">
<div class="cell-output-display">
<div id="fig-ifb2out" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb2out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb2out-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Conditional outfit detection rate (misfit item at -2 logits)"><img src="index_files/figure-html/fig-ifb2out-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb2out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Conditional outfit detection rate (misfit item at -2 logits)
</figcaption>
</figure>
</div>
</div>
</div>
<p>As shown in <a href="#fig-ifb0out" class="quarto-xref">Figure&nbsp;5</a>, <a href="#fig-ifb1out" class="quarto-xref">Figure&nbsp;6</a>, and <a href="#fig-ifb2out" class="quarto-xref">Figure&nbsp;7</a>, outfit is performing worse than infit across the board.</p>
</section>
<section id="comments" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="comments"><span class="header-section-number">3.1.3</span> Comments</h3>
<p>Based on these simulation, it is highly recommended to use infit over outfit in assessing item fit. The performance of outfit calls to question whether it is useful at all for detecting item misfit.</p>
<p>Regarding infit and the use of parametric bootstrapping with the function <code>RIgetfit()</code>, it looks like 100 iterations are to recommend to determine cutoff values when the sample size is 250 or lower, while 200 or 400 iterations reduce the risk for false positives at sample sizes of 500 or larger. False positives are found at sample sizes 500 and 1000 only. The risk for false positives is notably higher when the misfitting item is located at the sample mean compared to when the misfitting item is off-target by -1 logits or more.</p>
</section>
</section>
</section>
<section id="study-2-item-restscore" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Study 2: Item-restscore</h1>
<p>Item-restscore is a metric that compares an expected correlation with the observed correlation, using Goodman and Kruskal’s <span class="math inline">\(\gamma\)</span> <span class="citation" data-cites="goodman_measures_1954 kreiner_note_2011">(<a href="#ref-goodman_measures_1954" role="doc-biblioref">Goodman and Kruskal 1954</a>; <a href="#ref-kreiner_note_2011" role="doc-biblioref">Kreiner 2011</a>)</span>. Lower observed values than expected indicates than an item is underfit to the Rasch model, while higher values indicate overfit. The item-restscore function used in this simulation is from the <code>iarm</code> package <span class="citation" data-cites="mueller_iarm_2022">(<a href="#ref-mueller_iarm_2022" role="doc-biblioref">Mueller and Santiago 2022</a>)</span> and outputs Benjamini-Hochberg corrected <em>p</em>-values <span class="citation" data-cites="benjamini_controlling_1995">(<a href="#ref-benjamini_controlling_1995" role="doc-biblioref">Benjamini and Hochberg 1995</a>)</span>, which are used to determine whether the differences between the observed and expected values are statistically significant (using <em>p</em> &lt; .05 as critical value) for each item. The data and procedure in this study follow the same structure as Study 1, with the addition of a smaller sample condition with 100 respondents.</p>
<section id="results-1" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="results-1"><span class="header-section-number">4.1</span> Results</h2>
<div id="cell-fig-itemrestscore1" class="cell">
<div class="cell-output-display">
<div id="fig-itemrestscore1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-itemrestscore1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-itemrestscore1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: Item-restscore detection rate across targeting and sample size"><img src="index_files/figure-html/fig-itemrestscore1-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itemrestscore1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Item-restscore detection rate across targeting and sample size
</figcaption>
</figure>
</div>
</div>
</div>
<p>This simulation includes an additional condition with 100 respondents, which results in significantly lower detection rates compared to n = 150. Compared to infit at 250 respondents, item-restscore has detection rates of 95.2%, 90.9%, and 62.4% for targeting 0, -1, and -2, while infit has 96.5%, 96.5%, and 71%. For sample size 500 and 1000, detection rate is similar, including the increased tendency for false positives at n = 1000. The false positive rate is lower for item-restscore than infit for sample sizes below 1000.</p>
</section>
</section>
<section id="study-3-comparing-infit-and-item-restscore" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Study 3: Comparing infit and item-restscore</h1>
<p>We will now compare the performance of infit and item-restscore when all three items are misfitting at the same time. This simulation will also include a condition with 2000 respondents, to examine if the false positive rate increases with more respondents. For infit, we will use 100 iterations with <code>RIgetfit()</code> for n &lt; 500, and 200 iterations for n &gt;= 500, since this produced the best results in Study 1. Outfit is also included to see if it performs as badly as it did with only one misfitting item.</p>
<section id="results-2" class="level3" data-number="5.0.1">
<h3 data-number="5.0.1" class="anchored" data-anchor-id="results-2"><span class="header-section-number">5.0.1</span> Results</h3>
<div id="cell-fig-ifb3out" class="cell">
<div class="cell-output-display">
<div id="fig-ifb3out" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb3out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb3out-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9: Conditional outfit detection rate with three misfitting items"><img src="index_files/figure-html/fig-ifb3out-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb3out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Conditional outfit detection rate with three misfitting items
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-ifb3" class="cell">
<div class="cell-output-display">
<div id="fig-ifb3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;10: Conditional infit detection rate with three misfitting items"><img src="index_files/figure-html/fig-ifb3-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Conditional infit detection rate with three misfitting items
</figcaption>
</figure>
</div>
</div>
</div>
<p>Looking at the performance of infit with three misfitting items (<a href="#fig-ifb3" class="quarto-xref">Figure&nbsp;10</a>), we can see that the detection rate is markedly worse for item 13 (targeting -2 logits) in sample sizes 500 and below, compared to when single items were misfitting. The false positive rate has increased for sample size of 1000 and we can see it increase strongly at n = 2000. Outfit (<a href="#fig-ifb3out" class="quarto-xref">Figure&nbsp;9</a>) again performs worse than infit.</p>
<div id="cell-fig-ifb3b" class="cell">
<div class="cell-output-display">
<div id="fig-ifb3b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb3b-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;11: Conditional infit detection rate with three misfitting items"><img src="index_files/figure-html/fig-ifb3b-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ifb3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Conditional infit detection rate with three misfitting items
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ifb3b" class="quarto-xref">Figure&nbsp;11</a>, the minimal truncation used previously to remove extreme values (quantiles .001 and .999) was increased to .005 and .995. This improves the detection rate, particularly for the n = 250 condition and item 13, but also results in increased false positive rate.</p>
<div id="cell-fig-itemrestscore2" class="cell">
<div class="cell-output-display">
<div id="fig-itemrestscore2" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-itemrestscore2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-itemrestscore2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;12: "><img src="index_files/figure-html/fig-itemrestscore2-1.png" id="fig-itemrestscore2" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-itemrestscore2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-comp1" class="cell">
<div class="cell-output-display">
<div id="fig-comp1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-comp1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;13: Detection rate for item-restscore compared to infit"><img src="index_files/figure-html/fig-comp1-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Detection rate for item-restscore compared to infit
</figcaption>
</figure>
</div>
</div>
</div>
<p>Item-restscore (see <a href="#fig-itemrestscore2" class="quarto-xref">Figure&nbsp;12</a>) shows comparable detection rate to infit and higher levels of false positives. A comparison is made between the two in <a href="#fig-comp1" class="quarto-xref">Figure&nbsp;13</a>, where item-restscore is performing better than infit at detecting the -2 logits off-target item at n = 250, and better across all items for n = 500 and n = 1000. Infit performs better for samples n = 150 and n = 250 (except the item with location -2 logits).</p>
<div class="cell" data-tbl-colwidths="[60,40]">
<div id="tbl-overunder" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[60,40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-overunder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Item-restscore summary results across all sample sizes
</figcaption>
<div aria-describedby="tbl-overunder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 43%">
<col style="width: 28%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Item</th>
<th style="text-align: left;">Type of misfit</th>
<th style="text-align: right;">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">85.28</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">78.96</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">63.80</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">20.80</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">19.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">15.48</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">15.28</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">14.60</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">13.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">12.52</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">12.52</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">11.96</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">11.92</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">11.12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">8.96</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">7.28</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">7.24</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">5.96</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">5.16</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">1.24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">0.08</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Reviewing the type of misfit identified by item-restscore (see <a href="#tbl-overunder" class="quarto-xref">Table&nbsp;2</a>), the false positives are all overfitting the Rasch model, except for two instances (out of 2500) indicating underfit for item 12. Items 9, 13, and 18, that were simulated to be misfitting due to loading on a separate dimension, are as expected showing underfit to the Rasch model.</p>
</section>
</section>
<section id="study-4-bootstrapped-item-restscore" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Study 4: Bootstrapped item-restscore</h1>
<p>For our final set of simulations, we will use a non-parametric bootstrap procedure with item-restscore. The difference from the parametric bootstrap is that the non-parametric bootstrap samples with replacement directly from the observed response data. First, based on the above problematic sample size of 2000 when three items are misfitting, we will use the bootstrap function to sample with replacement using n = 800 and 250 bootstrap samples. The function <code>RIbootRestscore()</code> from the <code>easyRasch</code> package will be used.</p>
<div class="cell" data-tbl-colwidths="[60,40]">
<div id="tbl-bootir" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[60,40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bootir-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Example output from <code>RIbootRestscore()</code>
</figcaption>
<div aria-describedby="tbl-bootir-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 43%">
<col style="width: 28%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Item</th>
<th style="text-align: left;">Item-restscore result</th>
<th style="text-align: right;">Percent of iterations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">V9</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">100.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">V18</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">99.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V13</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">83.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">V14</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">42.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V10</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">38.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">V6</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">32.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V20</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">31.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">V7</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">26.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V16</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">21.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">V12</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">17.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V5</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">17.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">V2</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">16.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V8</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">8.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">V3</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">7.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V1</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">V17</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V11</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">V4</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V15</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">0.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">V19</td>
<td style="text-align: left;">overfit</td>
<td style="text-align: right;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V19</td>
<td style="text-align: left;">underfit</td>
<td style="text-align: right;">0.4</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><code>RIbootRestscore()</code> is demonstrated using a single sample in <a href="#tbl-bootir" class="quarto-xref">Table&nbsp;3</a>, where the table is sorted on Percent of iterations. The runtime was around 10-12 seconds using 8 CPU cores on a Macbook Pro M1 Max. In our simulation, we will repeat this procedure 500 times and report the average and standard deviation for the percent indicating misfit for each item.</p>
<p>Second, we will also apply the bootstrapped item-restscore method to sample sizes 150 and 250, using the complete sample for the same bootstrap procedure to see if this produces more useful information than previously tested strategies for identifying misfitting items.</p>
<section id="results-3" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="results-3"><span class="header-section-number">6.1</span> Results</h2>
<div id="cell-fig-irb0all" class="cell">
<div class="cell-output-display">
<div id="fig-irb0all" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-irb0all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-irb0all-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;14: Item-restscore bootstrap results"><img src="index_files/figure-html/fig-irb0all-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-irb0all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Item-restscore bootstrap results
</figcaption>
</figure>
</div>
</div>
</div>
<div id="tbl-irb0mis" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-irb0mis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Summary statistics for item-restscore bootstrap simulation
</figcaption>
<div aria-describedby="tbl-irb0mis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-irb0mis" style="flex-basis: 100.0%;justify-content: center;">
<div id="tbl-irb0mis-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-irb0mis-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Misfitting items
</figcaption>
<div aria-describedby="tbl-irb0mis-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-irb0mis-1" class="do-not-create-environment caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Item</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Percentile .05</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">V9</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">100.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">V18</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">99.8</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">99.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V13</td>
<td style="text-align: right;">95.6</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">93.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">76.4</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-irb0mis" style="flex-basis: 100.0%;justify-content: center;">
<div id="tbl-irb0mis-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-irb0mis-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) False positives
</figcaption>
<div aria-describedby="tbl-irb0mis-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-irb0mis-2" class="do-not-create-environment caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Item</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Percentile .95</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">V2</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">15.4</td>
<td style="text-align: right;">24.3</td>
<td style="text-align: right;">16.7</td>
<td style="text-align: right;">58.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">V6</td>
<td style="text-align: right;">18.4</td>
<td style="text-align: right;">14.2</td>
<td style="text-align: right;">21.3</td>
<td style="text-align: right;">14.9</td>
<td style="text-align: right;">52.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V8</td>
<td style="text-align: right;">14.4</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">15.6</td>
<td style="text-align: right;">51.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">V11</td>
<td style="text-align: right;">14.0</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">13.9</td>
<td style="text-align: right;">47.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V15</td>
<td style="text-align: right;">13.2</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: right;">16.6</td>
<td style="text-align: right;">13.4</td>
<td style="text-align: right;">45.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">V20</td>
<td style="text-align: right;">16.4</td>
<td style="text-align: right;">13.6</td>
<td style="text-align: right;">19.5</td>
<td style="text-align: right;">13.9</td>
<td style="text-align: right;">45.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V5</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: right;">15.7</td>
<td style="text-align: right;">12.6</td>
<td style="text-align: right;">44.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">V10</td>
<td style="text-align: right;">13.2</td>
<td style="text-align: right;">11.3</td>
<td style="text-align: right;">16.4</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">42.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V16</td>
<td style="text-align: right;">11.4</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">15.2</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">42.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">V7</td>
<td style="text-align: right;">13.2</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">16.7</td>
<td style="text-align: right;">12.6</td>
<td style="text-align: right;">41.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V1</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: right;">15.5</td>
<td style="text-align: right;">12.8</td>
<td style="text-align: right;">41.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">V3</td>
<td style="text-align: right;">10.8</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">13.6</td>
<td style="text-align: right;">11.2</td>
<td style="text-align: right;">36.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V14</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: right;">30.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">V12</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">29.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V4</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">10.2</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">29.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">V17</td>
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">8.4</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">24.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V19</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">13.6</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<p><a href="#fig-irb0all" class="quarto-xref">Figure&nbsp;14</a> shows that there is variation in false positive rate and it is nearly always indicating overfit, while the misfitting items are only indicated as underfit. The summary statistics in <a href="#tbl-irb0mis" class="quarto-xref">Table&nbsp;4</a> show that there can be quite a bit of variation for false positives, but the clear majority of results are below 50%. 3 items have 95th percentile values above 50, with the highest at 58.8.</p>
</section>
<section id="small-sample-n-150" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="small-sample-n-150"><span class="header-section-number">6.2</span> Small sample (n = 150)</h2>
<p>We will use 200 simulations to check the performance of the bootstrapped item-restscore function for sample size 150. As an additional experimental condition, we will use both 250 and 500 bootstrap iterations for item-restscore in each simulation.</p>
<div id="cell-fig-irboot150" class="cell">
<div class="cell-output-display">
<div id="fig-irboot150" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-irboot150-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-irboot150-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;15: "><img src="index_files/figure-html/fig-irboot150-1.png" id="fig-irboot150" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-irboot150-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15
</figcaption>
</figure>
</div>
</div>
</div>
<p>Item-restscore bootstrapping improves slightly on the single instance of item-restscore for the n = 150 condition (see <a href="#fig-irboot150" class="quarto-xref">Figure&nbsp;15</a>). When comparing to the previous results in <a href="#fig-itemrestscore2" class="quarto-xref">Figure&nbsp;12</a>, where the detection rate for the same sample size were at 49.2%, 14.6%, and 34.6% (for items 9, 13, and 18 respectively), the corresponding median values from the bootstrapped item-restscore with 250 iterations were 52.4%, 19.2%, and 38.4%. Using 500 bootstrap iterations did not result in relevant improvements over 250 iterations (see <a href="#tbl-irb150mis" class="quarto-xref">Table&nbsp;5</a>). Compared to the results using infit (<a href="#fig-ifb3" class="quarto-xref">Figure&nbsp;10</a>), with detection rates of 59.2%, 19%, and 51.8%, item-restscore inferior also when bootstrapped.</p>
<div class="cell">
<div id="tbl-irb150mis" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-irb150mis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Summary statistics for item-restscore bootstrap simulation (n = 150)
</figcaption>
<div aria-describedby="tbl-irb150mis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Bootstrap iterations</th>
<th style="text-align: left;">Item</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">MAD</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">V9</td>
<td style="text-align: right;">52.4</td>
<td style="text-align: right;">38.0</td>
<td style="text-align: right;">51.4</td>
<td style="text-align: right;">29.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">250</td>
<td style="text-align: left;">V18</td>
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">35.6</td>
<td style="text-align: right;">42.0</td>
<td style="text-align: right;">27.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">V13</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">21.9</td>
<td style="text-align: right;">27.3</td>
<td style="text-align: right;">25.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">V9</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">37.8</td>
<td style="text-align: right;">51.0</td>
<td style="text-align: right;">29.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">500</td>
<td style="text-align: left;">V18</td>
<td style="text-align: right;">37.2</td>
<td style="text-align: right;">35.9</td>
<td style="text-align: right;">41.4</td>
<td style="text-align: right;">27.9</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">V13</td>
<td style="text-align: right;">19.4</td>
<td style="text-align: right;">23.1</td>
<td style="text-align: right;">27.2</td>
<td style="text-align: right;">24.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="study-5-varying-the-number-of-items" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Study 5: Varying the number of items</h1>
<p>When doing simulation studies there is always a balance to strike between trying to evaluate many scenarios and not having too high complexity. We have been keeping several things constant, such as item locations and number of items, which makes interpretation easier but may limit the applicability of the results. For our final simulation, we will vary the number of items and the number of misfitting items. First, 40 dichotomous items will be used, adding 20 new item locations to the previously used set, with the same three items misfitting (items 9, 13, and 18). Second, items 1-10 out of the initial 20 items will be used, which means only item 9 will be misfit. We’ll again be using sample sizes of 150, 250, 500, and 1000.</p>
<p>Item-restscore and item infit will be compared. The latter will use 100 bootstrap iterations to determine critical values for sample sizes 150 and 250, and 200 bootstrap iterations for n &gt;= 500.</p>
<section id="results-40-items" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="results-40-items"><span class="header-section-number">7.1</span> Results 40 items</h2>
<div id="cell-fig-ifb40" class="cell">
<div class="cell-output-display">
<div id="fig-ifb40" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb40-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb40-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;16: "><img src="index_files/figure-html/fig-ifb40-1.png" id="fig-ifb40" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ifb40-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-itemrestscore40" class="cell">
<div class="cell-output-display">
<div id="fig-itemrestscore40" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-itemrestscore40-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-itemrestscore40-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;17: "><img src="index_files/figure-html/fig-itemrestscore40-1.png" id="fig-itemrestscore40" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-itemrestscore40-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17
</figcaption>
</figure>
</div>
</div>
</div>
<p>Infit performs better when sample size is 150 or 250 (see <a href="#fig-ifb40" class="quarto-xref">Figure&nbsp;16</a>), while performance is slightly better for item-restscore for n &gt;= 500 in terms of lower rates of false positives (see <a href="#fig-itemrestscore40" class="quarto-xref">Figure&nbsp;17</a>).</p>
</section>
<section id="results-10-items" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="results-10-items"><span class="header-section-number">7.2</span> Results 10 items</h2>
<div id="cell-fig-ifb10" class="cell">
<div class="cell-output-display">
<div id="fig-ifb10" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ifb10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ifb10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;18: "><img src="index_files/figure-html/fig-ifb10-1.png" id="fig-ifb10" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ifb10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-itemrestscore10" class="cell">
<div class="cell-output-display">
<div id="fig-itemrestscore10" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-itemrestscore10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-itemrestscore10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;19: "><img src="index_files/figure-html/fig-itemrestscore10-1.png" id="fig-itemrestscore10" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-itemrestscore10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-figure" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="summary-figure"><span class="header-section-number">7.3</span> Summary figure</h2>
<div id="cell-fig-comp10" class="cell">
<div class="cell-output-display">
<div id="fig-comp10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comp10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-comp10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;20: Detection rate for item-restscore and infit for 10 items"><img src="index_files/figure-html/fig-comp10-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comp10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: Detection rate for item-restscore and infit for 10 items
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-comp2040" class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>List of 1
 $ axis.title.x: list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 - attr(*, "class")= chr [1:2] "theme" "gg"
 - attr(*, "complete")= logi FALSE
 - attr(*, "validate")= logi TRUE</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-comp2040" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comp2040-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-comp2040-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Figure&nbsp;21: Detection rate for item-restscore and infit for 20 and 40 items"><img src="index_files/figure-html/fig-comp2040-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comp2040-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21: Detection rate for item-restscore and infit for 20 and 40 items
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-comp10" class="quarto-xref">Figure&nbsp;20</a> and <a href="#fig-comp2040" class="quarto-xref">Figure&nbsp;21</a> summarize the findings from the two different comparisons of item numbers. Adding more items improves the detection rate substantially for both methods, particularly for smaller samples and the off-target items. 40 items compared to 20 items results in a larger improvement for infit over item-restscore for the n = 150 condition, but also the n = 250 and n = 500 conditions for the -2 logits off-target item.</p>
</section>
</section>
<section id="study-6-conditional-likelihood-ratio-test" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Study 6: Conditional likelihood ratio test</h1>
<p>While global tests of model fit don’t provide any information about reasons for misfit when detected, they can be useful together with more specific tests such as those demonstrated in this paper. A commonly used global goodness-of-fit test is the Likelihood Ratio Test <span class="citation" data-cites="andersen_goodness_1973">(LRT, <a href="#ref-andersen_goodness_1973" role="doc-biblioref">Andersen 1973</a>)</span>, which is also implemented in the <code>eRm</code> package. While the global test is not central to the purposes of this paper (detecting item misfit), it could provide readers with a familiar test as a reference, and perhaps aid the item-focused methods in determining misfit. Previous simulation studies evaluating the LRT has however not found it to be sensitive to detect multidimensionality <span class="citation" data-cites="debelak_evaluation_2019">(<a href="#ref-debelak_evaluation_2019" role="doc-biblioref">Debelak 2019</a>)</span>.</p>
<p>For this simulation, sample sizes were set to 150, 250, 500, 1000, and 2000, using 1000 simulations for each condition. Study 6 follows the previous procedures. First the three datasets with one misfitting item out of 20, varying the misfitting items location (0, -1, and -2 logits). Then the datasets with three misfitting items, and comparing 20 and 40 items. And finally, one dataset with 10 items and one well-targeted misfitting item.</p>
<section id="results-4" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="results-4"><span class="header-section-number">8.1</span> Results</h2>
<div id="fig-lrt1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lrt1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-lrt1" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-lrt1-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-lrt1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-lrt1-1.png" class="lightbox" data-gallery="fig-lrt1" title="Figure&nbsp;22&nbsp;(a): Across sample sizes and location of misfit item"><img src="index_files/figure-html/fig-lrt1-1.png" class="img-fluid figure-img" data-ref-parent="fig-lrt1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-lrt1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Across sample sizes and location of misfit item
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-lrt1" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-lrt1-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-lrt1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-lrt1-2.png" class="lightbox" data-gallery="fig-lrt1" title="Figure&nbsp;22&nbsp;(b): Across sample sizes and number of items"><img src="index_files/figure-html/fig-lrt1-2.png" class="img-fluid figure-img" data-ref-parent="fig-lrt1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-lrt1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Across sample sizes and number of items
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lrt1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22: Likelihood ratio test detection rate
</figcaption>
</figure>
</div>
<p>Results for targeting of the misfit item are summarized in <a href="#fig-lrt1" class="quarto-xref">Figure&nbsp;22</a>, where the detection rate is reported based on the proportion of p-values below .05 in each condition.</p>
<p>LRT performs better than item-restscore for the off-target item conditions, especially when targeting was at -2 logits. Otherwise performance is similar. Infit is better than LRT for n &lt; 500 when targeting = 0, similar at targeting = 1, and LRT is better than infit at targeting -2.</p>
<p>Looking at LRT for different number of items and comparing to results for infit and item-restscore at their best detection rates for the corresponding number of items and sample size, it shows much worse performance for 10 items compared to infit and item-restscore at n = 150, but similar performance at larger sample sizes. For 20 and 40 items, LRT is similar to infit at all samples sizes, and slightly better than item-restscore for n &lt; 500.</p>
</section>
</section>
<section id="discussion" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Discussion</h1>
<p>This paper was created primarily out of a desire to understand the performance of conditional item fit and item-restscore in detecting item misfit. Studies 1-3 and 5 were originally planned, while study 4 was added due to the results of previous studies showing issues with large sample sizes, and study 6 was added mostly for didactic purposes but also out of curiousity of the global fit LRT performance compared to the other methods. Müller’s <span class="citation" data-cites="muller_item_2020">(<a href="#ref-muller_item_2020" role="doc-biblioref">2020</a>)</span> paper on conditional item fit was published five years ago with results that should have sparked discussions in the Rasch community about updating methods (and software) and the justification of rule-of-thumb critical values. We hope that this paper can help spur such discussions by the simple methodology and presentation of results used, which could make this paper more accessible for practitioners.</p>
<p>Main results summarized:</p>
<ul>
<li>small samples (n &lt; 250-500) with small numbers of items make it harder to detect misfitting items</li>
<li>small samples (n &lt; 250-500) should rely primarily on conditional item infit with bootstrap-derived critical values</li>
<li>large samples (n &gt; 500) should use bootstrapped item-restscore to reduce risk of falsely identifying misfit</li>
<li>misfit in off-target items is harder to detect than well-targeted items and the LRT test can assist in identifying misfit in off-target items</li>
<li>increased number of items increases the power to detect misfit</li>
</ul>
<p>Assessment of item fit and dimensionality should always be done using multiple methods. Study 6 showed the benefits of also looking at the likelihood ratio test when the misfitting item is located -2 logits away from the sample mean location. Previous simulation studies concluded that the LRT did not perform well at detecting multidimensionality, which is how the misfitting items were generate in this study. While no method in this study achieved very good results at the lowest sample size (n = 150), LRT did not do much worse than the other methods.</p>
<div id="cell-fig-loadloc" class="cell">
<div class="cell-output-display">
<div id="fig-loadloc" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-loadloc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-loadloc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Figure&nbsp;23: "><img src="index_files/figure-html/fig-loadloc-1.png" id="fig-loadloc" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-loadloc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;23
</figcaption>
</figure>
</div>
</div>
</div>
<p>Item fit and item-restscore is recommended to be used in parallel, while also examining residual patterns by reviewing standardized factor loadings on the first residual contrast (see <a href="#fig-loadloc" class="quarto-xref">Figure&nbsp;23</a> for an example using n = 400) as well as Yen’s Q3 residual correlations <span class="citation" data-cites="christensen_critical_2017">(<a href="#ref-christensen_critical_2017" role="doc-biblioref">Christensen, Makransky, and Horton 2017</a>)</span>. Regarding residual correlations and critical values, the <code>easyRasch</code> package also contains a function to use bootstrapping, similarly to the <code>RIgetfit()</code> function, to determine the appropriate cutoff. This is described briefly in a blog post <span class="citation" data-cites="johansson_simulation_2024">(<a href="#ref-johansson_simulation_2024" role="doc-biblioref">Johansson 2024b</a>)</span> and a simulation paper is under preparation.</p>
<p>Item fit in this paper has been assessed using data from all individual respondents in a sample. A useful additional method to evaluate and understand item fit or misfit is to inspect item characteristic curves where the sample is divided into class intervals based on their total score <span class="citation" data-cites="buchardt_visualizing_2023">(<a href="#ref-buchardt_visualizing_2023" role="doc-biblioref">Buchardt, Christensen, and Jensen 2023</a>)</span>.</p>
<p>While the simulations in this paper have all used dichotomous data, all functions evaluated from the <code>easyRasch</code> package in this paper also work with polytomous data using the Rasch Partial Credit Model.</p>
<section id="limitations" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="limitations"><span class="header-section-number">9.1</span> Limitations</h2>
<p>The total number of items and the proportion of misfit items clearly have effects on detection rate and could have been investigated further using more variations in sample sizes. The Rasch partial credit model for polytomous data <span class="citation" data-cites="masters_rasch_1982">(PCM, <a href="#ref-masters_rasch_1982" role="doc-biblioref">Masters 1982</a>)</span> would have been useful to include in a comparison study. When testing the bootstrapped item-restscore method, more variations in the number of bootstrap samples (iterations) might have been of interest, although the difference between 250 and 500 was small.</p>
</section>
</section>
<section id="conclusion" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Conclusion</h1>
<p>For sample sizes under 500, it seems best to rely primarily on item infit with simulation based critical values, using 100 iterations with <code>RIgetfit()</code>. For sample sizes closer to 500, item-restscore is recommended as primary method, either as a single-run test or bootstrapped. With samples larger than 500, bootstrapped item-restscore controls false positive rates well, while showing high rates of misfit detection. Using 250 iterations for the bootstrapped item-restscore seems adequate. In general, both infit and item-restscore are useful in the analysis process if you have a sample size below 1000.</p>
<p>The findings reported here also make a good argument for removing one item at a time when the analysis indicates several misfitting items, starting with the most underfitting item. This is especially relevant for n &gt;= 500 and when misfitting items are located close to the sample mean.</p>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-andersen_goodness_1973" class="csl-entry" role="listitem">
Andersen, Erling B. 1973. <span>“A Goodness of Fit Test for the Rasch Model.”</span> <em>Psychometrika</em> 38 (1): 123–40. <a href="https://doi.org/10.1007/BF02291180">https://doi.org/10.1007/BF02291180</a>.
</div>
<div id="ref-benjamini_controlling_1995" class="csl-entry" role="listitem">
Benjamini, Yoav, and Yosef Hochberg. 1995. <span>“Controlling the <span>False</span> <span>Discovery</span> <span>Rate</span>: <span>A</span> <span>Practical</span> and <span>Powerful</span> <span>Approach</span> to <span>Multiple</span> <span>Testing</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 57 (1): 289–300. <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">https://doi.org/10.1111/j.2517-6161.1995.tb02031.x</a>.
</div>
<div id="ref-bond_applying_2015" class="csl-entry" role="listitem">
Bond, Trevor, and Christine M. Fox. 2015. <em>Applying the <span>Rasch</span> <span>Model</span>: <span>Fundamental</span> <span>Measurement</span> in the <span>Human</span> <span>Sciences</span></em>. 3rd ed. London, UNITED KINGDOM: Routledge.
</div>
<div id="ref-buchardt_visualizing_2023" class="csl-entry" role="listitem">
Buchardt, Ann-Sophie, Karl Bang Christensen, and Normann Jensen. 2023. <span>“Visualizing <span>Rasch</span> Item Fit Using Conditional Item Characteristic Curves in <span>R</span>.”</span> <em>Psychological Test and Assessment Modeling</em> 65 (2): 206–19.
</div>
<div id="ref-chou_checking_2010" class="csl-entry" role="listitem">
Chou, Yeh-Tai, and Wen-Chung Wang. 2010. <span>“Checking <span>Dimensionality</span> in <span>Item</span> <span>Response</span> <span>Models</span> <span>With</span> <span>Principal</span> <span>Component</span> <span>Analysis</span> on <span>Standardized</span> <span>Residuals</span>.”</span> <em>Educational and Psychological Measurement</em> 70 (5): 717–31. <a href="https://doi.org/10.1177/0013164410379322">https://doi.org/10.1177/0013164410379322</a>.
</div>
<div id="ref-christensen_critical_2017" class="csl-entry" role="listitem">
Christensen, Karl Bang, Guido Makransky, and Mike Horton. 2017. <span>“Critical <span>Values</span> for <span>Yen</span>’s <span>Q3</span>: <span>Identification</span> of <span>Local</span> <span>Dependence</span> in the <span>Rasch</span> <span>Model</span> <span>Using</span> <span>Residual</span> <span>Correlations</span>.”</span> <em>Applied Psychological Measurement</em> 41 (3): 178–94. <a href="https://doi.org/10.1177/0146621616677520">https://doi.org/10.1177/0146621616677520</a>.
</div>
<div id="ref-debelak_evaluation_2019" class="csl-entry" role="listitem">
Debelak, Rudolf. 2019. <span>“An <span>Evaluation</span> of <span>Overall</span> <span>Goodness</span>-of-<span>Fit</span> <span>Tests</span> for the <span>Rasch</span> <span>Model</span>.”</span> <em>Frontiers in Psychology</em> 9 (January). <a href="https://doi.org/10.3389/fpsyg.2018.02710">https://doi.org/10.3389/fpsyg.2018.02710</a>.
</div>
<div id="ref-goodman_measures_1954" class="csl-entry" role="listitem">
Goodman, Leo A., and William H. Kruskal. 1954. <span>“Measures of <span>Association</span> for <span>Cross</span> <span>Classifications</span>.”</span> <em>Journal of the American Statistical Association</em> 49 (268): 732–64. <a href="https://doi.org/10.2307/2281536">https://doi.org/10.2307/2281536</a>.
</div>
<div id="ref-easyrasch" class="csl-entry" role="listitem">
Johansson, Magnus. 2024a. <em>easyRasch: Psychometric Analysis in r with Rasch Measurement Theory</em>. <a href="https://github.com/pgmj/easyRasch">https://github.com/pgmj/easyRasch</a>.
</div>
<div id="ref-johansson_simulation_2024" class="csl-entry" role="listitem">
———. 2024b. <span>“Simulation Based Cutoff Values for <span>Rasch</span> Item Fit and Residual Correlations.”</span> <em>R, Rasch, Etc</em>. <a href="https://pgmj.github.io/simcutoffs.html">https://pgmj.github.io/simcutoffs.html</a>.
</div>
<div id="ref-kreiner_note_2011" class="csl-entry" role="listitem">
Kreiner, Svend. 2011. <span>“A <span>Note</span> on <span>Item</span>–<span>Restscore</span> <span>Association</span> in <span>Rasch</span> <span>Models</span>.”</span> <em>Applied Psychological Measurement</em> 35 (7): 557–61. <a href="https://doi.org/10.1177/0146621611410227">https://doi.org/10.1177/0146621611410227</a>.
</div>
<div id="ref-mair_extended_2007" class="csl-entry" role="listitem">
Mair, Patrick, and Reinhold Hatzinger. 2007. <span>“Extended <span>Rasch</span> <span>Modeling</span>: <span>The</span> <span class="nocase">eRm</span> <span>Package</span> for the <span>Application</span> of <span>IRT</span> <span>Models</span> in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 20 (1): 1–20. <a href="https://doi.org/10.18637/jss.v020.i09">https://doi.org/10.18637/jss.v020.i09</a>.
</div>
<div id="ref-masters_rasch_1982" class="csl-entry" role="listitem">
Masters, Geoff N. 1982. <span>“A <span>Rasch</span> <span>Model</span> for <span>Partial</span> <span>Credit</span> <span>Scoring</span>.”</span> <em>Psychometrika</em> 47 (2): 149–74. <a href="https://doi.org/10.1007/BF02296272">https://doi.org/10.1007/BF02296272</a>.
</div>
<div id="ref-mcneish_direct_2024" class="csl-entry" role="listitem">
McNeish, Daniel, and Melissa G. Wolf. 2024. <span>“Direct <span>Discrepancy</span> <span>Dynamic</span> <span>Fit</span> <span>Index</span> <span>Cutoffs</span> for <span>Arbitrary</span> <span>Covariance</span> <span>Structure</span> <span>Models</span>.”</span> <em>Structural Equation Modeling: A Multidisciplinary Journal</em> 31 (5): 835–62. <a href="https://doi.org/10.1080/10705511.2024.2308005">https://doi.org/10.1080/10705511.2024.2308005</a>.
</div>
<div id="ref-mueller_iarm_2022" class="csl-entry" role="listitem">
Mueller, Marianne, and Pedro Henrique Ribeiro Santiago. 2022. <span>“Iarm: <span>Item</span> <span>Analysis</span> in <span>Rasch</span> <span>Models</span>.”</span> <a href="https://cran.r-project.org/web/packages/iarm/index.html">https://cran.r-project.org/web/packages/iarm/index.html</a>.
</div>
<div id="ref-muller_item_2020" class="csl-entry" role="listitem">
Müller, Marianne. 2020. <span>“Item Fit Statistics for <span>Rasch</span> Analysis: Can We Trust Them?”</span> <em>Journal of Statistical Distributions and Applications</em> 7 (1): 5. <a href="https://doi.org/10.1186/s40488-020-00108-7">https://doi.org/10.1186/s40488-020-00108-7</a>.
</div>
<div id="ref-ostini_polytomous_2006" class="csl-entry" role="listitem">
Ostini, Remo, and Michael Nering. 2006. <em>Polytomous <span>Item</span> <span>Response</span> <span>Theory</span> <span>Models</span></em>. SAGE Publications, Inc. <a href="https://doi.org/10.4135/9781412985413">https://doi.org/10.4135/9781412985413</a>.
</div>
<div id="ref-smith_detecting_2002" class="csl-entry" role="listitem">
Smith, Everett V. 2002. <span>“<a href="https://www.ncbi.nlm.nih.gov/pubmed/12011501">Detecting and Evaluating the Impact of Multidimensionality Using Item Fit Statistics and Principal Component Analysis of Residuals</a>.”</span> <em>Journal of Applied Measurement</em> 3 (2): 205–31.
</div>
<div id="ref-smith_using_1998" class="csl-entry" role="listitem">
Smith, R. M., R. E. Schumacker, and M. J. Bush. 1998. <span>“<a href="https://www.ncbi.nlm.nih.gov/pubmed/9661732">Using Item Mean Squares to Evaluate Fit to the <span>Rasch</span> Model</a>.”</span> <em>Journal of Outcome Measurement</em> 2 (1): 66–78.
</div>
<div id="ref-warm_weighted_1989" class="csl-entry" role="listitem">
Warm, Thomas A. 1989. <span>“Weighted Likelihood Estimation of Ability in Item Response Theory.”</span> <em>Psychometrika</em> 54 (3): 427–50. <a href="https://doi.org/10.1007/BF02294627">https://doi.org/10.1007/BF02294627</a>.
</div>
</div>
</section>
<section id="sec-addmat" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Additional materials</h1>
<ul>
<li>GitHub link for <code>easyRasch</code> source code: <a href="https://github.com/pgmj/easyRasch/" class="uri">https://github.com/pgmj/easyRasch/</a>
<ul>
<li>Most functions are defined in this file: <a href="https://github.com/pgmj/easyRasch/blob/main/R/easyRasch.R" class="uri">https://github.com/pgmj/easyRasch/blob/main/R/easyRasch.R</a></li>
</ul></li>
</ul>
<section id="session-info" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="session-info"><span class="header-section-number">11.1</span> Session info</h2>
<p>This documents the specific R packages and versions used in this study. Note that the simulations were conducted using <code>easyRasch</code> version 0.3.3, while the plots and tables generated directly from <code>easyRasch</code> were done using version 0.3.3.2.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.2

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Stockholm
tzcode source: internal

attached base packages:
 [1] parallel  grid      stats4    stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] showtext_0.9-7    showtextdb_3.0    sysfonts_0.8.9    arrow_16.1.0     
 [5] easyRasch_0.3.3.2 doParallel_1.0.17 iterators_1.0.14  furrr_0.3.1      
 [9] future_1.34.0     foreach_1.5.2     janitor_2.2.0     hexbin_1.28.4    
[13] catR_3.17         glue_1.8.0        ggrepel_0.9.6     patchwork_1.3.0  
[17] reshape_0.8.9     matrixStats_1.4.1 psychotree_0.16-1 psychotools_0.7-4
[21] partykit_1.2-22   mvtnorm_1.3-1     libcoin_1.0-10    psych_2.4.6.26   
[25] mirt_1.43         lattice_0.22-6    kableExtra_1.4.0  formattable_0.2.1
[29] lubridate_1.9.3   forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4      
[33] purrr_1.0.2       readr_2.1.5       tidyr_1.3.1       tibble_3.2.1     
[37] tidyverse_2.0.0   ggdist_3.3.2      iarm_0.4.3        ggplot2_3.5.1    
[41] eRm_1.0-6        

loaded via a namespace (and not attached):
  [1] splines_4.4.2        R.oo_1.26.0          cellranger_1.1.0    
  [4] rpart_4.1.23         lifecycle_1.0.4      rprojroot_2.0.4     
  [7] globals_0.16.3       vroom_1.6.5          MASS_7.3-61         
 [10] backports_1.5.0      magrittr_2.0.3       vcd_1.4-12          
 [13] Hmisc_5.2-0          rmarkdown_2.28       yaml_2.3.10         
 [16] sessioninfo_1.2.2    pbapply_1.7-2        RColorBrewer_1.1-3  
 [19] audio_0.1-11         quadprog_1.5-8       R.utils_2.12.3      
 [22] nnet_7.3-19          listenv_0.9.1        testthat_3.2.1.1    
 [25] RPushbullet_0.3.4    vegan_2.6-8          parallelly_1.38.0   
 [28] svglite_2.1.3        permute_0.9-7        codetools_0.2-20    
 [31] xml2_1.3.6           tidyselect_1.2.1     farver_2.1.2        
 [34] base64enc_0.1-3      jsonlite_1.8.9       progressr_0.14.0    
 [37] Formula_1.2-5        survival_3.7-0       systemfonts_1.1.0   
 [40] tools_4.4.2          gnm_1.1-5            snow_0.4-4          
 [43] Rcpp_1.0.13-1        mnormt_2.1.1         gridExtra_2.3       
 [46] xfun_0.46            here_1.0.1           mgcv_1.9-1          
 [49] distributional_0.4.0 ca_0.71.1            withr_3.0.2         
 [52] beepr_2.0            fastmap_1.2.0        fansi_1.0.6         
 [55] digest_0.6.37        timechange_0.3.0     R6_2.5.1            
 [58] colorspace_2.1-1     R.methodsS3_1.8.2    inum_1.0-5          
 [61] utf8_1.2.4           generics_0.1.3       data.table_1.16.0   
 [64] SimDesign_2.17.1     htmlwidgets_1.6.4    pkgconfig_2.0.3     
 [67] gtable_0.3.5         lmtest_0.9-40        brio_1.1.5          
 [70] htmltools_0.5.8.1    scales_1.3.0         snakecase_0.11.1    
 [73] knitr_1.48           rstudioapi_0.17.1    tzdb_0.4.0          
 [76] checkmate_2.3.2      nlme_3.1-166         curl_6.0.1          
 [79] zoo_1.8-12           relimp_1.0-5         vcdExtra_0.8-5      
 [82] foreign_0.8-87       pillar_1.9.0         vctrs_0.6.5         
 [85] Deriv_4.1.3          cluster_2.1.6        dcurver_0.9.2       
 [88] archive_1.1.8        GPArotation_2024.3-1 htmlTable_2.4.3     
 [91] evaluate_1.0.1       cli_3.6.3            compiler_4.4.2      
 [94] rlang_1.1.4          crayon_1.5.3         future.apply_1.11.2 
 [97] labeling_0.4.3       plyr_1.8.9           stringi_1.8.4       
[100] viridisLite_0.4.2    assertthat_0.2.1     munsell_0.5.1       
[103] Matrix_1.7-1         qvcalc_1.0.3         hms_1.1.3           
[106] bit64_4.0.5          bit_4.0.5            readxl_1.4.3        </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>